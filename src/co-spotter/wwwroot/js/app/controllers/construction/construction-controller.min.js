angular.module('construction-controller', [])

.controller('constructionController', ['$scope', '$http', function ($scope, $http) {

    /*Initialize Materials*/

    SmartDesign.DropDownList.init();
    SmartDesign.Accrodion.init();
    SmartDesign.ImageViewer.init();

    /****************************/

    /*Initialize Canvas Toolbar*/

    var canvasToolbar = new Toolbar('canvas-tools');

    function emphasizeToolSelection(sender) {

        var icon = sender.getElementsByTagName('I')[0];

        var emph_overlay = document.getElementById('emph-overlay');

        emph_overlay.innerHTML = '';

        var icon_for_overlay = document.createElement("I");

        icon_for_overlay.className = icon.className;

        emph_overlay.appendChild(icon_for_overlay);

        if (sender.attributes['tool-title']) {
            var title = document.createElement('p');
            title.innerHTML = sender.attributes['tool-title'].value;

            emph_overlay.appendChild(title);
        }

        emph_overlay.classList.add('show');

        setTimeout(function () {
            emph_overlay.classList.remove('show');
        }, 750);
    }

    canvasToolbar.setToolFunction('all', function () {
        console.log(this.toolType);

        emphasizeToolSelection(this);

    });

    /****************************/

    /*Initialize Department Dropdownlist*/

    var ddlDepartment = SmartDesign.DropDownList.fetchById('ddlDepartment', {
        collapse_after_select: false,
        show_selected: false
    });

    ddlDepartment.onexpand = function () {
        console.log('expand');
    }

    ddlDepartment.oncollapse = function () {
        console.log('collapse');
    }

    ddlDepartment.onSelectedItemChanged = function () {
        console.log(this.getSelectedItem());
    }

    /****************************/

    /*Set ImageViewer Album*/
    //SmartDesign.ImageViewer.setAlbum([
    //    { src: 'img/img.jpg', title: 'Lorem ipsum dolor sit amet.' },
    //    { src: 'img/img2.jpg' }, { src: 'img/img3.jpg' },
    //    { src: 'img/img4.jpg' }, { src: 'img/img5.jpg' },
    //    { src: 'img/img6.jpg' }, { src: 'img/img7.jpg' },
    //    { src: 'img/img8.jpg' }, { src: 'img/img9.jpg' },
    //    { src: 'img/img10.jpg' }, { src: 'img/img11.jpg' }
    //], false);

    /****************************/

    /*Create a modal window for zone details*/

    var modal = new SmartDesign.Modal({
        id: 'modal-zone-detail',
        dissmiss: true,
        close_button: true,
        size: 'medium',//defalut
        animation: true,
        fit_to_bot: true
    });

    $scope.showZoneDetail = function () { modal.show(); }

    /****************************/

    /*CCC.js Initialize*/

    var config = {
        width: 300,
        height: 300,
        canvas: 'construction-canvas',
        $http: $http,
        debugMod: true
    };

    var ccc = new cccjs(config);
}]);